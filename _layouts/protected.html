---
---

<!doctype html>
{% include copyright.html %}
<html lang="{{ site.locale | replace: "_", "-" | default: "en" }}" class="no-js">
  <head>
    {% include head.html %}
    {% include head/custom.html %}
  </head>

  <body class="layout--{{ page.layout | default: layout.layout }}{% if page.classes or layout.classes %}{{ page.classes | default: layout.classes | join: ' ' | prepend: ' ' }}{% endif %}" dir="{% if site.rtl %}rtl{% else %}ltr{% endif %}">
    {% include_cached skip-links.html %}
    {% include_cached masthead.html %}
    

    <script>
    function checkPassword() {
      var password = document.getElementById("password-input").value;
      var encryptedContent = document.getElementById("protected-content").textContent.trim();
      
      decryptContent(encryptedContent, password)
        .then(decryptedContent => {
          console.log("Decryption successful");
          document.getElementById('password-protection').style.display = 'none';
          document.getElementById('protected-content').innerHTML = decryptedContent;
          document.getElementById('protected-content').style.display = 'block';
        })
        .catch(error => {
          console.error("Decryption failed:", error);
          alert("Incorrect password or invalid content. Please try again.");
        });
    }
    

    function decryptContent(encryptedContent, password) {
      
      // Decode the base64 encoded content
      let encryptedBytes;
      try {
        encryptedBytes = atob(encryptedContent);
      } catch (error) {
        throw new Error("Invalid encrypted content");
      }
      
      // Extract IV and ciphertext
      const iv = encryptedBytes.slice(0, 16);
      const ciphertext = encryptedBytes.slice(16);
      
      // Convert password to key
      const keyBytes = new TextEncoder().encode(password.padEnd(32, '\0').slice(0, 32));
      
      // Import the key
      return crypto.subtle.importKey(
        "raw",
        keyBytes,
        { name: "AES-CBC" },
        false,
        ["decrypt"]
      ).then(key => {
        // Decrypt the content
        return crypto.subtle.decrypt(
          { name: "AES-CBC", iv: new Uint8Array(iv.split('').map(c => c.charCodeAt(0))) },
          key,
          new Uint8Array(ciphertext.split('').map(c => c.charCodeAt(0)))
        );
      }).then(decryptedBytes => {
        // Convert decrypted bytes to text
        return new TextDecoder().decode(decryptedBytes);
      });
          
    }
    </script>

    <style>
      input {
        border: 2px solid #007BFF; /* Change color as needed */
        background-color: #f0f8ff; /* Light background color */
        padding: 10px; 
        border-radius: 10px; 
      }
    </style>

    <div class="initial-content">
      <div id="main" role="main">

        <div id="password-protection">
          <p>This page is password protected. Please enter the password to view the content.</p>
          <p>If you don't have the password, contact me.</p>
          <input type="password" id="password-input" placeholder="Enter your password here...">
          <button onclick="checkPassword()">Submit</button>
        </div>

        <div id="protected-content" style="display: none;">
          {{ content | escape }}
        </div>
        {% include after-content.html %}
      </div>
    </div>

    {% if site.search == true %}
      <div class="search-content">
        {% include_cached search/search_form.html %}
      </div>
    {% endif %}

    <div id="footer" class="page__footer">
      <footer>
        {% include footer/custom.html %}
        {% include_cached footer.html %}
      </footer>
    </div>

    {% include scripts.html %}
  </body>
</html>
